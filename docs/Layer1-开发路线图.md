# 武林小镇 (wulin-town) - 开发路线图

> 文档级别：Layer 1
> 版本：1.0
> 日期：2026-01-07
> 状态：待用户审核

---

## 一、项目目标

**用 AI 技术，让《武林外传》的角色在 AI 时代永生，继续同福客栈的故事。**

面向《武林外传》电视剧同好群体的粉丝二创作品。

---

## 二、核心用户体验

| 序号 | 体验 | 说明 | 优先级 |
|------|------|------|--------|
| 1 | **观看角色自动互动** | 像看电视剧一样，看角色们自己聊天、走动 | 核心 |
| 2 | **和角色对话** | 点击角色，和 ta 聊天 | 核心 |
| 3 | **查看大事记** | 看"第X回：发生了什么" | 核心 |

---

## 三、不做清单

以下功能明确不在开发范围内：

| 功能 | 原因 |
|------|------|
| ❌ 多场景切换 | 维护成本高，专注同福客栈 |
| ❌ 复杂的触发事件 | 增加复杂度 |
| ❌ 自定义角色移动动画 | 保留原有像素风格即可 |
| ❌ 成就系统 | 非核心体验 |
| ❌ 存档功能 | 非核心体验 |

---

## 四、开发阶段

### 阶段一：能跑起来（最小可用版本）

**目标**：让朋友可以来玩

#### 必须完成的任务

| 序号 | 任务 | 类型 | 状态 |
|------|------|------|------|
| 1.1 | 配置硅基流动 API | 配置 | ⏳ 待做 |
| 1.2 | 配置 Jina Embedding API | 配置 | ⏳ 待做 |
| 1.3 | 替换背景音乐 | 资源 | ⏳ 待做 |
| 1.4 | 本地运行测试 | 测试 | ⏳ 待做 |
| 1.5 | 部署上线 | 部署 | ⏳ 待做 |

#### 完成标准

- [ ] 角色可以自动行走和互相对话
- [ ] 用户可以点击角色进行对话
- [ ] 对话内容符合角色人设
- [ ] 背景音乐是武林外传主题

---

### 阶段二：体验优化

**目标**：让体验更好

#### 任务清单

| 序号 | 任务 | 类型 | 状态 |
|------|------|------|------|
| 2.1 | 添加角色头像（9个） | 资源 | ⏳ 待做 |
| 2.2 | 界面文字中文化 | 开发 | ⏳ 待做 |
| 2.3 | 大事记展示界面 | 开发 | ⏳ 待做 |

#### 完成标准

- [ ] 对话框显示角色头像
- [ ] 按钮、提示文字为中文
- [ ] 可以查看角色之间发生的"大事记"

---

### 阶段三：锦上添花（可选）

**目标**：有精力再做

| 序号 | 任务 | 类型 | 状态 |
|------|------|------|------|
| 3.1 | 添加中文字体 | 资源 | ⏳ 可选 |
| 3.2 | 自定义 favicon | 资源 | ⏳ 可选 |
| 3.3 | 自定义场景地图 | 资源 | ⏳ 可选 |
| 3.4 | 解决精灵图重复问题 | 开发 | ⏳ 可选 |

---

## 五、阶段一详细步骤

### 步骤 1.1：配置硅基流动 API

1. 登录硅基流动官网获取 API Key
2. 在 Convex Dashboard 配置环境变量：
   ```
   LLM_API_URL=https://api.siliconflow.cn/v1
   LLM_API_KEY=你的API密钥
   LLM_MODEL=deepseek-v3（或 qwen-xxx）
   ```

### 步骤 1.2：配置 Jina Embedding API

1. 登录 Jina AI 官网获取 API Key
2. 在 Convex Dashboard 配置环境变量：
   ```
   JINA_API_KEY=你的Jina API密钥
   ```

### 步骤 1.3：替换背景音乐

1. 准备武林外传主题音乐（MP3 格式，< 10MB）
2. 替换 `public/wulin-town/assets/background.mp3`

### 步骤 1.4：本地运行测试

```bash
# 安装依赖
npm install

# 启动 Convex 开发服务器
npx convex dev

# 启动前端开发服务器
npm run dev
```

### 步骤 1.5：部署上线

1. 将代码推送到 GitHub
2. 在 Vercel 连接仓库并部署
3. 在 Convex Dashboard 配置生产环境变量

---

## 六、阶段二详细步骤

### 步骤 2.1：添加角色头像

1. 准备 9 个角色头像（JPG/PNG，200x200~400x400）
2. 按命名规范放入 `public/wulin-town/assets/portraits/`
3. 修改前端代码显示头像

### 步骤 2.2：界面文字中文化

需要修改的位置：
| 位置 | 当前 | 目标 |
|------|------|------|
| 音乐按钮 | Music/Mute | 音乐/静音 |
| 互动按钮 | Interact | 互动 |
| 其他按钮 | ... | ... |

### 步骤 2.3：大事记展示界面

1. 创建大事记组件
2. 从 Convex 获取对话摘要
3. 以"第X回"格式展示

---

## 七、资源依赖

### 阶段一需要

| 资源 | 提供者 | 状态 |
|------|--------|------|
| 硅基流动 API Key | 用户 | ⏳ 待提供 |
| Jina API Key | 用户 | ⏳ 待提供 |
| 背景音乐 | 用户 | ⏳ 待提供 |

### 阶段二需要

| 资源 | 提供者 | 状态 |
|------|--------|------|
| 9个角色头像 | 用户 | ⏳ 待提供 |

---

## 八、风险和注意事项

| 风险 | 应对措施 |
|------|----------|
| API 费用超预算 | 监控使用量，控制对话频率 |
| Convex 免费层级不够 | 监控存储使用，必要时清理历史数据 |
| 角色对话不符合人设 | 调优 prompt，增加约束条件 |

---

## 九、成本预算

| 项目 | 月预算 | 说明 |
|------|--------|------|
| 硅基流动 API | ~¥3-6 | 每天 100 条对话 |
| Jina API | 免费层级 | 有免费额度 |
| Convex | 免费层级 | 1GB 存储 |
| Vercel | 免费层级 | 静态部署 |
| **总计** | **~$1/月** | 在 $2 预算内 |

---

## 十、里程碑

| 里程碑 | 标志 |
|--------|------|
| 🏁 阶段一完成 | 朋友可以访问并和角色聊天 |
| 🏁 阶段二完成 | 有头像、中文界面、大事记 |
| 🏁 阶段三完成 | 完善的视觉和体验 |

---

*文档待用户审核确认*
